"use strict";(self.webpackChunkordspelet=self.webpackChunkordspelet||[]).push([[987],{1987:(Lt,pe,h)=>{h.r(pe),h.d(pe,{GameModule:()=>X});var C=h(6895),B=h(6319),ue=h(793),t=h(4650),K={};!function s(n,e,a,i){var c=!!(n.Worker&&n.Blob&&n.Promise&&n.OffscreenCanvas&&n.OffscreenCanvasRenderingContext2D&&n.HTMLCanvasElement&&n.HTMLCanvasElement.prototype.transferControlToOffscreen&&n.URL&&n.URL.createObjectURL);function l(){}function x(o){var r=e.exports.Promise,m=void 0!==r?r:n.Promise;return"function"==typeof m?new m(o):(o(l,l),null)}var r,m,o,d,g,ae,I=(o=Math.floor(16.666666666666668),d={},g=0,"function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?(r=function(f){var p=Math.random();return d[p]=requestAnimationFrame(function u(y){g===y||g+o-1<y?(g=y,delete d[p],f()):d[p]=requestAnimationFrame(u)}),p},m=function(f){d[f]&&cancelAnimationFrame(d[f])}):(r=function(f){return setTimeout(f,o)},m=function(f){return clearTimeout(f)}),{frame:r,cancel:m}),N=function(){var o,r,m={};return function(){if(o)return o;if(!a&&c){var g=["var CONFETTI, SIZE = {}, module = {};","("+s.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join("\n");try{o=new Worker(URL.createObjectURL(new Blob([g])))}catch(f){return void 0!==typeof console&&"function"==typeof console.warn&&console.warn("\u{1f38a} Could not load worker",f),null}!function d(g){function f(p,u){g.postMessage({options:p||{},callback:u})}g.init=function(u){var y=u.transferControlToOffscreen();g.postMessage({canvas:y},[y])},g.fire=function(u,y,T){if(r)return f(u,null),r;var v=Math.random().toString(36).slice(2);return r=x(function(_){function M(w){w.data.callback===v&&(delete m[v],g.removeEventListener("message",M),r=null,T(),_())}g.addEventListener("message",M),f(u,v),m[v]=M.bind(null,{data:{callback:v}})})},g.reset=function(){for(var u in g.postMessage({reset:!0}),m)m[u](),delete m[u]}}(o)}return o}}(),re={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function b(o,r,m){return function ft(o,r){return r?r(o):o}(o&&function ht(o){return null!=o}(o[r])?o[r]:re[r],m)}function gt(o){return o<0?0:Math.floor(o)}function vt(o,r){return Math.floor(Math.random()*(r-o))+o}function oe(o){return parseInt(o,16)}function wt(o){return o.map(yt)}function yt(o){var r=String(o).replace(/[^0-9a-f]/gi,"");return r.length<6&&(r=r[0]+r[0]+r[1]+r[1]+r[2]+r[2]),{r:oe(r.substring(0,2)),g:oe(r.substring(2,4)),b:oe(r.substring(4,6))}}function Ct(o){o.width=document.documentElement.clientWidth,o.height=document.documentElement.clientHeight}function Mt(o){var r=o.getBoundingClientRect();o.width=r.width,o.height=r.height}function Dt(o){var r=o.angle*(Math.PI/180),m=o.spread*(Math.PI/180);return{x:o.x,y:o.y,wobble:10*Math.random(),wobbleSpeed:Math.min(.11,.1*Math.random()+.05),velocity:.5*o.startVelocity+Math.random()*o.startVelocity,angle2D:-r+(.5*m-Math.random()*m),tiltAngle:(.5*Math.random()+.25)*Math.PI,color:o.color,shape:o.shape,tick:0,totalTicks:o.ticks,decay:o.decay,drift:o.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*o.gravity,ovalScalar:.6,scalar:o.scalar}}function Oe(o,r){var v,m=!o,d=!!b(r||{},"resize"),g=b(r,"disableForReducedMotion",Boolean),p=c&&b(r||{},"useWorker")?N():null,u=m?Ct:Mt,y=!(!o||!p||!o.__confetti_initialized),T="function"==typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function _(w,se,ie){for(var F=b(w,"particleCount",gt),H=b(w,"angle",Number),V=b(w,"spread",Number),P=b(w,"startVelocity",Number),St=b(w,"decay",Number),It=b(w,"gravity",Number),Pt=b(w,"drift",Number),Se=b(w,"colors",wt),Gt=b(w,"ticks",Number),Ie=b(w,"shapes"),$t=b(w,"scalar"),Pe=function bt(o){var r=b(o,"origin",Object);return r.x=b(r,"x",Number),r.y=b(r,"y",Number),r}(w),Ge=F,ce=[],kt=o.width*Pe.x,Ut=o.height*Pe.y;Ge--;)ce.push(Dt({x:kt,y:Ut,angle:H,spread:V,startVelocity:P,color:Se[Ge%Se.length],shape:Ie[vt(0,Ie.length)],ticks:Gt,decay:St,gravity:It,drift:Pt,scalar:$t}));return v?v.addFettis(ce):(v=function Tt(o,r,m,d,g){var u,y,f=r.slice(),p=o.getContext("2d"),T=x(function(v){function _(){u=y=null,p.clearRect(0,0,d.width,d.height),g(),v()}u=I.frame(function M(){a&&!(d.width===i.width&&d.height===i.height)&&(d.width=o.width=i.width,d.height=o.height=i.height),!d.width&&!d.height&&(m(o),d.width=o.width,d.height=o.height),p.clearRect(0,0,d.width,d.height),f=f.filter(function(w){return function Ot(o,r){r.x+=Math.cos(r.angle2D)*r.velocity+r.drift,r.y+=Math.sin(r.angle2D)*r.velocity+r.gravity,r.wobble+=r.wobbleSpeed,r.velocity*=r.decay,r.tiltAngle+=.1,r.tiltSin=Math.sin(r.tiltAngle),r.tiltCos=Math.cos(r.tiltAngle),r.random=Math.random()+2,r.wobbleX=r.x+10*r.scalar*Math.cos(r.wobble),r.wobbleY=r.y+10*r.scalar*Math.sin(r.wobble);var m=r.tick++/r.totalTicks,d=r.x+r.random*r.tiltCos,g=r.y+r.random*r.tiltSin,f=r.wobbleX+r.random*r.tiltCos,p=r.wobbleY+r.random*r.tiltSin;if(o.fillStyle="rgba("+r.color.r+", "+r.color.g+", "+r.color.b+", "+(1-m)+")",o.beginPath(),"circle"===r.shape)o.ellipse?o.ellipse(r.x,r.y,Math.abs(f-d)*r.ovalScalar,Math.abs(p-g)*r.ovalScalar,Math.PI/10*r.wobble,0,2*Math.PI):function xt(o,r,m,d,g,f,p,u,y){o.save(),o.translate(r,m),o.rotate(f),o.scale(d,g),o.arc(0,0,1,p,u,y),o.restore()}(o,r.x,r.y,Math.abs(f-d)*r.ovalScalar,Math.abs(p-g)*r.ovalScalar,Math.PI/10*r.wobble,0,2*Math.PI);else if("star"===r.shape)for(var u=Math.PI/2*3,y=4*r.scalar,T=8*r.scalar,v=r.x,_=r.y,M=5,w=Math.PI/M;M--;)v=r.x+Math.cos(u)*T,_=r.y+Math.sin(u)*T,o.lineTo(v,_),u+=w,v=r.x+Math.cos(u)*y,_=r.y+Math.sin(u)*y,o.lineTo(v,_),u+=w;else o.moveTo(Math.floor(r.x),Math.floor(r.y)),o.lineTo(Math.floor(r.wobbleX),Math.floor(g)),o.lineTo(Math.floor(f),Math.floor(p)),o.lineTo(Math.floor(d),Math.floor(r.wobbleY));return o.closePath(),o.fill(),r.tick<r.totalTicks}(p,w)}),f.length?u=I.frame(M):_()}),y=_});return{addFettis:function(v){return f=f.concat(v),T},canvas:o,promise:T,reset:function(){u&&I.cancel(u),y&&y()}}}(o,ce,u,se,ie)).promise}function M(w){var se=g||b(w,"disableForReducedMotion",Boolean),ie=b(w,"zIndex",Number);if(se&&T)return x(function(P){P()});m&&v?o=v.canvas:m&&!o&&(o=function _t(o){var r=document.createElement("canvas");return r.style.position="fixed",r.style.top="0px",r.style.left="0px",r.style.pointerEvents="none",r.style.zIndex=o,r}(ie),document.body.appendChild(o)),d&&!y&&u(o);var F={width:o.width,height:o.height};function H(){if(p){var P={getBoundingClientRect:function(){if(!m)return o.getBoundingClientRect()}};return u(P),void p.postMessage({resize:{width:P.width,height:P.height}})}F.width=F.height=null}function V(){v=null,d&&n.removeEventListener("resize",H),m&&o&&(document.body.removeChild(o),o=null,y=!1)}return p&&!y&&p.init(o),y=!0,p&&(o.__confetti_initialized=!0),d&&n.addEventListener("resize",H,!1),p?p.fire(w,F,V):_(w,F,V)}return M.reset=function(){p&&p.reset(),v&&v.reset()},M}function Te(){return ae||(ae=Oe(null,{useWorker:!0,resize:!0})),ae}e.exports=function(){return Te().apply(this,arguments)},e.exports.reset=function(){Te().reset()},e.exports.create=Oe}(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),K,!1);const $e=K.exports;class G{constructor(){this.fn=$e,this.defaultOptions={particleCount:100,spread:70,origin:{y:.7}}}getOptions(n){return Object.assign({},this.defaultOptions,n??{})}run(n){const e=this.getOptions(n);return this.fn(e)}runDelay(n=0,e){return setTimeout(()=>this.run(e),n??0)}static#e=this.\u0275fac=function(e){return new(e||G)};static#t=this.\u0275prov=t.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"})}class E{constructor(n){this.confetti=n,this._options={...this.confetti.defaultOptions}}set options(n){this._options=this.confetti.getOptions(n)}get options(){return this._options}ngOnInit(){clearTimeout(this.timer),this.timer=this.confetti.runDelay(this.options.delay,this.options)}ngOnDestroy(){clearTimeout(this.timer)}static#e=this.\u0275fac=function(e){return new(e||E)(t.Y36(G))};static#t=this.\u0275dir=t.lG2({type:E,selectors:[["","confetti",""]],inputs:{options:["confetti","options"]},exportAs:["confetti"]})}class J{static#e=this.\u0275fac=function(e){return new(e||J)};static#t=this.\u0275mod=t.oAB({type:J});static#n=this.\u0275inj=t.cJS({})}var ke=h(3336);class W{constructor(){this.fill=!1,this.fillColor="var(--color-accent)"}static#e=this.\u0275fac=function(e){return new(e||W)};static#t=this.\u0275cmp=t.Xpm({type:W,selectors:[["app-star"]],inputs:{fill:"fill",fillColor:"fillColor"},decls:2,vars:2,template:function(e,a){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"star"),t.qZA()),2&e&&t.Udp("color",a.fill?a.fillColor:"var(--color-fg-op-50)")},dependencies:[ke.Hw],styles:["[_nghost-%COMP%]{display:inline-block}"]})}function Ue(s,n){if(1&s&&(t.TgZ(0,"span",1),t._UZ(1,"app-star",2),t.qZA()),2&s){const e=n.$implicit,a=n.index,i=t.oxw();t.Udp("transform",i.warpedStyles[a]),t.xp6(1),t.Q6J("fill",null!=i.ratio&&i.ratio>=e)}}class A{constructor(){this.ratios=[0,.5,.9],this.warpedStyles=[]}ngOnChanges(){this.calcWarpedStyles()}calcWarpedStyles(){if(!this.warped)return;const n=this.warped,e=this.ratios.length/2,a=Math.ceil(e),i=new Array(a).fill(0).map((c,l)=>n*(l/(a-1)-n/2));i.push(i[i.length-1]),this.warpedStyles=this.ratios.map((c,l)=>`translateY(${-(l<=e?i[l]:i[2*e-l-1])}em)`)}static#e=this.\u0275fac=function(e){return new(e||A)};static#t=this.\u0275cmp=t.Xpm({type:A,selectors:[["app-stars"]],inputs:{ratio:"ratio",ratios:"ratios",warped:"warped"},features:[t.TTD],decls:1,vars:1,consts:[["class","star-wrapper",3,"transform",4,"ngFor","ngForOf"],[1,"star-wrapper"],[3,"fill"]],template:function(e,a){1&e&&t.YNc(0,Ue,2,3,"span",0),2&e&&t.Q6J("ngForOf",a.ratios)},dependencies:[C.sg,W],styles:[".star-wrapper[_ngcontent-%COMP%]{display:inline-block}"]})}class R{static#e=this.\u0275fac=function(e){return new(e||R)};static#t=this.\u0275mod=t.oAB({type:R});static#n=this.\u0275inj=t.cJS({imports:[C.ez,ue.q]})}var me=h(655),fe=h(7579),Le=h(727),We=(h(2076),h(515),h(5577),h(2722));const Ae=t.GuJ,Ne=Symbol("__destroy"),ge=Symbol("__decoratorApplied");function ve(s){return"string"==typeof s?Symbol(`__destroy__${s}`):Ne}function we(s,n){s[n]||(s[n]=new fe.x)}function ye(s,n){s[n]&&(s[n].next(),s[n].complete(),s[n]=null)}function be(s){s instanceof Le.w0&&s.unsubscribe()}function Ce(s,n){return function(){if(s&&s.call(this),ye(this,ve()),n.arrayName&&function Je(s){Array.isArray(s)&&s.forEach(be)}(this[n.arrayName]),n.checkProperties)for(const e in this)n.blackList?.includes(e)||be(this[e])}}function Me(s={}){return n=>{!function Ze(s){return!!s[Ae]}(n)?function Re(s,n){s.prototype.ngOnDestroy=Ce(s.prototype.ngOnDestroy,n)}(n,s):function Ye(s,n){const e=s.\u0275pipe;e.onDestroy=Ce(e.onDestroy,n)}(n,s),function Be(s){s.prototype[ge]=!0}(n)}}Symbol("CheckerHasBeenSet");var Z=(()=>{return(s=Z||(Z={}))[s.MapLowerToUpper=0]="MapLowerToUpper",s[s.MapUpperToLower=1]="MapUpperToLower",Z;var s})(),Y=h(5861),$=h(1135),D=h(4004),k=h(9841),q=h(1884),He=h(9300),ee=h(1881),Ve=h(2313);class O{constructor(n){this.store=n,this.game$=new $.X(null),this.wordsetId$=this.game$.pipe((0,D.U)(e=>e?.wordsetId)),this.wordset$=(0,k.a)([this.store.wordSets$,this.wordsetId$]).pipe((0,D.U)(([e,a])=>e.find(i=>i.id===a))),this._subGameIndex$=new $.X(0),this.subGameIndex$=this._subGameIndex$.asObservable(),this.subGame$=(0,k.a)([this.subGameIndex$,this.game$]).pipe((0,D.U)(([e,a])=>a?.subGames[e])),this.gameInfo$=(0,k.a)([this.game$,this.wordset$,this.subGameIndex$]).pipe((0,q.x)(ee.Q),(0,He.h)(([e,a])=>!(!e||!a)),(0,D.U)(([e,a,i])=>{const c=(e?.subGames||[]).map((x,I)=>({index:I,...x}));return{...e,wordset:a,subGames:c,subGame:{curr:c[i],prev:c[i-1],next:c[i+1]}}}))}init(n,e){const a=Object.values(Z).filter(l=>"number"==typeof l);e||(e=a);const c={wordsetId:n,subGames:e.filter(l=>a.includes(parseInt(l.toString()))).map(l=>({type:l}))};return this.game$.next(c),this._subGameIndex$.next(0),c}setSubGameIndex(n){null==n&&(n=(this.game$.value?.subGames||[]).findIndex(e=>!!e.endedAt)),(n<0||n>=(this.game$.value?.subGames||[]).length)&&(n=0),this._subGameIndex$.next(n)}patchSubGame(n){var e=this;return(0,Y.Z)(function*(){const a=e.game$.value;if(!a||!a.subGames)return;const c={...a.subGames[e._subGameIndex$.value],...n},l={...a,subGames:[...a.subGames]};return l.subGames[e._subGameIndex$.value]=c,e.game$.next(l),l})()}static#e=this.\u0275fac=function(e){return new(e||O)(t.LFG(Ve.d))};static#t=this.\u0275prov=t.Yz7({token:O,factory:O.\u0275fac})}var Ke=h(4859);function qe(s,n){1&s&&(t.TgZ(0,"span"),t._uU(1,"Next"),t.qZA())}function et(s,n){1&s&&(t.TgZ(0,"span"),t._uU(1,"Close"),t.qZA())}const tt=function(){return{delay:2e3}};function nt(s,n){if(1&s){const e=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"header",3)(3,"h1",4),t._uU(4,"Nice job!"),t.qZA()(),t.TgZ(5,"div",5)(6,"div",6),t._UZ(7,"app-stars",7),t.qZA()(),t.TgZ(8,"footer",3)(9,"button",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.close.emit())}),t.YNc(10,qe,2,0,"span",9),t.YNc(11,et,2,0,"span",9),t.qZA()()()()}if(2&s){const e=t.oxw();t.xp6(1),t.Q6J("confetti",t.DdM(5,tt)),t.xp6(6),t.Q6J("ratio",null==e.currSubGame?null:e.currSubGame.scoreRatio)("warped",.3),t.xp6(3),t.Q6J("ngIf",!e.nextSubGame),t.xp6(1),t.Q6J("ngIf",e.nextSubGame)}}class Q{constructor(){this.close=new t.vpe}get show(){return!(!this.currSubGame?.endedAt||!this.currSubGame.scoreRatio)}static#e=this.\u0275fac=function(e){return new(e||Q)};static#t=this.\u0275cmp=t.Xpm({type:Q,selectors:[["app-game-ended"]],inputs:{currSubGame:"currSubGame",nextSubGame:"nextSubGame"},outputs:{close:"close"},decls:1,vars:1,consts:[["class","modal-wrapper fadeIn",4,"ngIf"],[1,"modal-wrapper","fadeIn"],[1,"modal-box","scaleUp",3,"confetti"],[1,"p-1","text-center"],[1,"m-0","scaleUp"],[1,"px-1","flex-center"],[1,"ts-300p","lh-80"],[1,"d-block",3,"ratio","warped"],["mat-raised-button","","color","primary",3,"click"],[4,"ngIf"]],template:function(e,a){1&e&&t.YNc(0,nt,12,6,"div",0),2&e&&t.Q6J("ngIf",a.show)},dependencies:[C.O5,Ke.lW,A,E],styles:[".fadeIn[_ngcontent-%COMP%]{opacity:0;animation:.5s _ngcontent-%COMP%_fadeIn forwards}.scaleUp[_ngcontent-%COMP%]{transform:scale(0);animation:.5s _ngcontent-%COMP%_scaleUp cubic-bezier(.5,0,.5,2.2) forwards}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_scaleUp{0%{transform:scale(0)}to{transform:scale(1)}}.modal-box[_ngcontent-%COMP%]{min-width:16em}.modal-box.scaleUp[_ngcontent-%COMP%]{animation-delay:.3s}.modal-box[_ngcontent-%COMP%]   h1.scaleUp[_ngcontent-%COMP%]{animation-delay:.8s}@keyframes _ngcontent-%COMP%_scaleUpSpin{0%{transform:scale(0) rotate(-180deg)}to{transform:scale(1) rotate(0)}}[_nghost-%COMP%]     app-stars .star-wrapper app-star{transform:scale(0) rotate(-180deg);animation:.7s _ngcontent-%COMP%_scaleUpSpin cubic-bezier(.5,0,.5,2.2) forwards}[_nghost-%COMP%]     app-stars .star-wrapper:nth-of-type(1) app-star{animation-delay:1s}[_nghost-%COMP%]     app-stars .star-wrapper:nth-of-type(2) app-star{animation-delay:1.2s}[_nghost-%COMP%]     app-stars .star-wrapper:nth-of-type(3) app-star{animation-delay:1.4s}"]})}const rt=["*"];var S=(()=>{return(s=S||(S={})).Idle="idle",s.Hover="hover",s.Wrong="wrong",s.Correct="correct",S;var s})();class j{constructor(){this.state=S.Idle}static#e=this.\u0275fac=function(e){return new(e||j)};static#t=this.\u0275cmp=t.Xpm({type:j,selectors:[["app-word"]],inputs:{state:"state",bgcolor:"bgcolor",innerStyle:"innerStyle",innerClass:"innerClass"},ngContentSelectors:rt,decls:2,vars:7,consts:[[3,"ngClass","ngStyle"]],template:function(e,a){1&e&&(t.F$t(),t.TgZ(0,"span",0),t.Hsn(1),t.qZA()),2&e&&(t.Gre("state-",a.state,""),t.Udp("background-color",a.bgcolor),t.Q6J("ngClass",a.innerClass)("ngStyle",a.innerStyle))},dependencies:[C.mk,C.PC],styles:["[_nghost-%COMP%] > span[_ngcontent-%COMP%]{display:block;position:relative;padding:.5em;color:var(--color-fg);background:var(--color-bg);background:white;border-radius:.5em;box-shadow:.1em .1em .25em var(--color-dark-op-10);border:.1em solid var(--color-fg-op-50);transition:.2s;transition-property:transform,box-shadow,background}[_nghost-%COMP%] > span.state-idle[_ngcontent-%COMP%], [_nghost-%COMP%] > span.state-hover[_ngcontent-%COMP%]{background:lightyellow}[_nghost-%COMP%] > span.state-hover[_ngcontent-%COMP%]{transform:scale(1.15)}[_nghost-%COMP%] > span.state-wrong[_ngcontent-%COMP%]{background:salmon!important;animation:.5s .2s _ngcontent-%COMP%_wrong ease-in-out 1}[_nghost-%COMP%] > span.state-correct[_ngcontent-%COMP%]{background:palegreen!important;animation:1.5s .1s _ngcontent-%COMP%_correct ease-in-out 1 forwards}@keyframes _ngcontent-%COMP%_wrong{0%,to{transform:translate(0)}15%,45%,75%{transform:translate(-.5em)}30%,60%,90%{transform:translate(.5em)}}@keyframes _ngcontent-%COMP%_correct{0%,10%,30%,50%{transform:scale(1)}20%,40%{transform:scale(1.15)}0%,80%{opacity:1}to{opacity:.5}}"]})}var te=h(2340);function ot(s,n){if(1&s){const e=t.EpF();t.TgZ(0,"div",5),t.NdJ("cdkDragDropped",function(i){t.CHM(e);const c=t.oxw(2);return t.KtG(c.onDragDrop(i))}),t.TgZ(1,"app-word",6),t._uU(2),t.qZA()()}if(2&s){const e=t.oxw().ngIf,a=t.oxw();t.Q6J("cdkDragData",e.currWord),t.xp6(2),t.hij(" ",a.formatWord(e.currWord,!0)," ")}}function at(s,n){if(1&s){const e=t.EpF();t.TgZ(0,"div",7),t.NdJ("cdkDropListEntered",function(i){t.CHM(e);const c=t.oxw(2);return t.KtG(c.onDragEnter(i))})("cdkDropListExited",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.reset())}),t.TgZ(1,"app-word",8),t._uU(2),t.qZA()()}if(2&s){const e=n.$implicit,a=t.oxw().ngIf,i=t.oxw();t.Q6J("cdkDropListDisabled",e.done)("cdkDropListData",e),t.xp6(1),t.Q6J("state",i.wordState(e,a.hoveredWord,a.wrongWord)),t.xp6(1),t.hij(" ",i.formatWord(e.word,!1)," ")}}function st(s,n){if(1&s&&(t.TgZ(0,"div",1)(1,"main",2),t.YNc(2,ot,3,2,"div",3),t.qZA(),t.TgZ(3,"aside"),t.YNc(4,at,3,4,"div",4),t.qZA()()),2&s){const e=n.ngIf,a=t.oxw();t.xp6(2),t.Q6J("ngIf",e.currWord),t.xp6(2),t.Q6J("ngForOf",e.wordsStatus)("ngForTrackBy",a.trackByWord)}}let ne=class le{constructor(n,e){this.game=n,this.confetti=e,this.wordsDone$=new $.X([]),this.wordsStatus$=(0,k.a)([this.game.wordset$,this.wordsDone$]).pipe((0,D.U)(([a,i])=>(a?.words||[]).map(c=>({word:c,done:i.includes(c)})))),this.wordsLeft$=this.wordsStatus$.pipe((0,D.U)(a=>a.filter(i=>!i.done).map(i=>i.word))),this.currWord$=this.wordsLeft$.pipe((0,q.x)(ee.Q),(0,D.U)(a=>a[Math.floor(Math.random()*a.length)])),this.hoveredWord$=new $.X(void 0),this.wrongWord$=new $.X(void 0),this.wrongMoves$=new $.X([]),this.stats$=(0,k.a)([this.wordsDone$,this.wordsLeft$,this.wrongMoves$]).pipe((0,D.U)(([a,i,c])=>{const l=a.length,I=c.length,N=l+I;return{done:l,left:i.length,wrong:I,total:N,scoreRatio:N>0?l/N:0}})),this.$$=(0,k.a)([this.wordsStatus$,this.currWord$,this.hoveredWord$,this.wrongWord$]).pipe((0,D.U)(([a,i,c,l])=>({wordsStatus:a,currWord:i,hoveredWord:c,wrongWord:l})))}ngOnInit(){const n=Date.now();this.game.patchSubGame({startedAt:n}),this.stats$.pipe((0,q.x)(ee.Q),function Xe(s,n){return e=>{const a=ve(n);return"string"==typeof n?function ze(s,n,e){const a=s[n];we(s,e),s[n]=function(){a.apply(this,arguments),ye(this,e),s[n]=a}}(s,n,a):we(s,a),e.pipe((0,We.R)(s[a]))}}(this)).subscribe(e=>{const{scoreRatio:a,left:i}=e,c=i<=0?Date.now():void 0;this.game.patchSubGame({scoreRatio:a,endedAt:c})})}trackByWord(n,e){return e.word}formatWord(n,e){return n[e&&!this.inversed||this.inversed&&!e?"toLocaleUpperCase":"toLocaleLowerCase"]()}addWordDone(n){this.wordsDone$.next([...this.wordsDone$.value,n])}reset(){this.hoveredWord$.next(void 0),this.wrongWord$.next(void 0)}onDragDrop(n){var e=this;return(0,Y.Z)(function*(){const a=n.item.data,i=n.container.data?.word;a===i?(e.addWordDone(a),e.confettiByEvent(n.event)):(e.reset(),i&&!n.container.disabled&&(e.wrongWord$.next(i),e.wrongMoves$.next([...e.wrongMoves$.value,{from:a,to:i}]),clearTimeout(e._aniTimer),e._aniTimer=setTimeout(()=>e.reset(),1200)))})()}onDragEnter(n){this.reset(),this.hoveredWord$.next(n.container.data.word)}wordState(n,e,a){return n.done?S.Correct:e===n.word?S.Hover:a===n.word?S.Wrong:S.Idle}confettiByEvent(n){const{clientX:e,clientY:a}=n.changedTouches?.[0]||n,{innerWidth:i,innerHeight:c}=n.view;this.confetti.run({origin:{x:e/i,y:a/c},particleCount:12,spread:70,startVelocity:15})}static#e=this.\u0275fac=function(e){return new(e||le)(t.Y36(O),t.Y36(G))};static#t=this.\u0275cmp=t.Xpm({type:le,selectors:[["app-map-lower-upper-words"]],inputs:{inversed:"inversed"},decls:2,vars:3,consts:[["cdkDropListGroup","","class","wrapper full-fill bg-op-5",4,"ngIf"],["cdkDropListGroup","",1,"wrapper","full-fill","bg-op-5"],["cdkDropList","",1,"flex-center"],["class","p-1","cdkDrag","",3,"cdkDragData","cdkDragDropped",4,"ngIf"],["cdkDropList","",3,"cdkDropListDisabled","cdkDropListData","cdkDropListEntered","cdkDropListExited",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",1,"p-1",3,"cdkDragData","cdkDragDropped"],["bgcolor","var(--color-primary-light-2)","innerClass","px-1 ts-120p"],["cdkDropList","",3,"cdkDropListDisabled","cdkDropListData","cdkDropListEntered","cdkDropListExited"],[3,"state"]],template:function(e,a){1&e&&(t.YNc(0,st,5,3,"div",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,a.$$))},dependencies:[C.sg,C.O5,te.Wj,te.Fd,te.Zt,j,C.Ov],styles:[".wrapper[_ngcontent-%COMP%]{display:grid;grid-template:auto/auto minmax(10em,30%)}@media (orientation: portrait){.wrapper[_ngcontent-%COMP%]{grid-template:8em auto/auto}}.wrapper[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]{display:grid;grid-template:auto/auto;align-items:center;overflow:auto;gap:.5em;padding:1em}@media (orientation: portrait){.wrapper[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]{grid-template:auto/repeat(2,calc(50% - .25em))}}.cdk-drag-placeholder[_ngcontent-%COMP%]{display:none}"]})};function it(s,n){1&s&&t._UZ(0,"app-map-lower-upper-words")}function ct(s,n){1&s&&t._UZ(0,"app-map-lower-upper-words",5),2&s&&t.Q6J("inversed",!0)}function lt(s,n){if(1&s){const e=t.EpF();t.ynx(0)(1,1),t.YNc(2,it,1,0,"app-map-lower-upper-words",2),t.YNc(3,ct,1,1,"app-map-lower-upper-words",3),t.BQk(),t.TgZ(4,"app-game-ended",4),t.NdJ("close",function(){const c=t.CHM(e).ngIf,l=t.oxw();return t.KtG(l.setNextOrExit(c.subGame.next))}),t.qZA(),t.BQk()}if(2&s){const e=n.ngIf,a=t.oxw();t.xp6(1),t.Q6J("ngSwitch",e.subGame.curr.type),t.xp6(1),t.Q6J("ngSwitchCase",a.SubGameType.MapLowerToUpper),t.xp6(1),t.Q6J("ngSwitchCase",a.SubGameType.MapUpperToLower),t.xp6(1),t.Q6J("currSubGame",e.subGame.curr)("nextSubGame",e.subGame.next)}}ne=(0,me.gn)([Me()],ne);let z=class de{constructor(n,e){this.game=n,this.router=e,this.SubGameType=Z}setNextOrExit(n){n?this.game.setSubGameIndex(n.index):this.router.navigate(["/home"])}static#e=this.\u0275fac=function(e){return new(e||de)(t.Y36(O),t.Y36(B.F0))};static#t=this.\u0275cmp=t.Xpm({type:de,selectors:[["app-game"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"inversed",4,"ngSwitchCase"],[3,"currSubGame","nextSubGame","close"],[3,"inversed"]],template:function(e,a){1&e&&(t.YNc(0,lt,5,5,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,a.game.gameInfo$))},dependencies:[C.O5,C.RF,C.n9,Q,ne,C.Ov],encapsulation:2})};z=(0,me.gn)([Me()],z);var dt=h(6805),pt=h(930);class U{constructor(n,e){this.game=n,this.router=e}canActivate(n){var e=this;return(0,Y.Z)(function*(){const a=n.params.wordsetId,i=n.queryParams.subGames?.split(","),c=e.game.init(a,i);return e.router.createUrlTree(["/game",c.wordsetId])})()}static#e=this.\u0275fac=function(e){return new(e||U)(t.LFG(O),t.LFG(B.F0))};static#t=this.\u0275prov=t.Yz7({token:U,factory:U.\u0275fac})}class L{constructor(n,e){this.game=n,this.router=e}canActivate(n){var e=this;return(0,Y.Z)(function*(){const a=n.params.wordsetId,i=yield function ut(s,n){const e="object"==typeof n;return new Promise((a,i)=>{const c=new pt.Hp({next:l=>{a(l),c.unsubscribe()},error:i,complete:()=>{e?a(n.defaultValue):i(new dt.K)}});s.subscribe(c)})}(e.game.game$),c=e.router.createUrlTree(["/game",a,"new"]);return!!i||c})()}static#e=this.\u0275fac=function(e){return new(e||L)(t.LFG(O),t.LFG(B.F0))};static#t=this.\u0275prov=t.Yz7({token:L,factory:L.\u0275fac})}const mt=[{path:":wordsetId",component:z,canActivate:[L]},{path:":wordsetId/new",component:z,canActivate:[U]}];class X{static#e=this.\u0275fac=function(e){return new(e||X)};static#t=this.\u0275mod=t.oAB({type:X});static#n=this.\u0275inj=t.cJS({providers:[O,U,L],imports:[C.ez,B.Bz.forChild(mt),ue.q,R,J]})}}}]);