"use strict";(self.webpackChunkordspelet=self.webpackChunkordspelet||[]).push([[41],{41:(St,ie,y)=>{y.r(ie),y.d(ie,{GameModule:()=>H});var _=y(6895),Z=y(6319),ce=y(793),t=y(4650),V={};!function a(n,e,s,i){var c=!!(n.Worker&&n.Blob&&n.Promise&&n.OffscreenCanvas&&n.OffscreenCanvasRenderingContext2D&&n.HTMLCanvasElement&&n.HTMLCanvasElement.prototype.transferControlToOffscreen&&n.URL&&n.URL.createObjectURL);function l(){}function C(o){var r=e.exports.Promise,m=void 0!==r?r:n.Promise;return"function"==typeof m?new m(o):(o(l,l),null)}var r,m,o,p,h,ne,I=(o=Math.floor(16.666666666666668),p={},h=0,"function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?(r=function(f){var d=Math.random();return p[d]=requestAnimationFrame(function u(w){h===w||h+o-1<w?(h=w,delete p[d],f()):p[d]=requestAnimationFrame(u)}),d},m=function(f){p[f]&&cancelAnimationFrame(p[f])}):(r=function(f){return setTimeout(f,o)},m=function(f){return clearTimeout(f)}),{frame:r,cancel:m}),ee=function(){var o,r,m={};return function(){if(o)return o;if(!s&&c){var h=["var CONFETTI, SIZE = {}, module = {};","("+a.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join("\n");try{o=new Worker(URL.createObjectURL(new Blob([h])))}catch(f){return void 0!==typeof console&&"function"==typeof console.warn&&console.warn("\u{1f38a} Could not load worker",f),null}!function p(h){function f(d,u){h.postMessage({options:d||{},callback:u})}h.init=function(u){var w=u.transferControlToOffscreen();h.postMessage({canvas:w},[w])},h.fire=function(u,w,x){if(r)return f(u,null),r;var g=Math.random().toString(36).slice(2);return r=C(function(D){function M(v){v.data.callback===g&&(delete m[g],h.removeEventListener("message",M),r=null,x(),D())}h.addEventListener("message",M),f(u,g),m[g]=M.bind(null,{data:{callback:g}})})},h.reset=function(){for(var u in h.postMessage({reset:!0}),m)m[u](),delete m[u]}}(o)}return o}}(),it={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function b(o,r,m){return function ct(o,r){return r?r(o):o}(o&&function lt(o){return null!=o}(o[r])?o[r]:it[r],m)}function pt(o){return o<0?0:Math.floor(o)}function dt(o,r){return Math.floor(Math.random()*(r-o))+o}function te(o){return parseInt(o,16)}function ut(o){return o.map(mt)}function mt(o){var r=String(o).replace(/[^0-9a-f]/gi,"");return r.length<6&&(r=r[0]+r[0]+r[1]+r[1]+r[2]+r[2]),{r:te(r.substring(0,2)),g:te(r.substring(2,4)),b:te(r.substring(4,6))}}function ht(o){o.width=document.documentElement.clientWidth,o.height=document.documentElement.clientHeight}function gt(o){var r=o.getBoundingClientRect();o.width=r.width,o.height=r.height}function yt(o){var r=o.angle*(Math.PI/180),m=o.spread*(Math.PI/180);return{x:o.x,y:o.y,wobble:10*Math.random(),wobbleSpeed:Math.min(.11,.1*Math.random()+.05),velocity:.5*o.startVelocity+Math.random()*o.startVelocity,angle2D:-r+(.5*m-Math.random()*m),tiltAngle:(.5*Math.random()+.25)*Math.PI,color:o.color,shape:o.shape,tick:0,totalTicks:o.ticks,decay:o.decay,drift:o.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*o.gravity,ovalScalar:.6,scalar:o.scalar}}function ye(o,r){var g,m=!o,p=!!b(r||{},"resize"),h=b(r,"disableForReducedMotion",Boolean),d=c&&b(r||{},"useWorker")?ee():null,u=m?ht:gt,w=!(!o||!d||!o.__confetti_initialized),x="function"==typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function D(v,re,oe){for(var F=b(v,"particleCount",pt),z=b(v,"angle",Number),X=b(v,"spread",Number),S=b(v,"startVelocity",Number),Ct=b(v,"decay",Number),Mt=b(v,"gravity",Number),Dt=b(v,"drift",Number),_e=b(v,"colors",ut),xt=b(v,"ticks",Number),Ce=b(v,"shapes"),Ot=b(v,"scalar"),Me=function ft(o){var r=b(o,"origin",Object);return r.x=b(r,"x",Number),r.y=b(r,"y",Number),r}(v),De=F,ae=[],Tt=o.width*Me.x,It=o.height*Me.y;De--;)ae.push(yt({x:Tt,y:It,angle:z,spread:X,startVelocity:S,color:_e[De%_e.length],shape:Ce[dt(0,Ce.length)],ticks:xt,decay:Ct,gravity:Mt,drift:Dt,scalar:Ot}));return g?g.addFettis(ae):(g=function _t(o,r,m,p,h){var u,w,f=r.slice(),d=o.getContext("2d"),x=C(function(g){function D(){u=w=null,d.clearRect(0,0,p.width,p.height),h(),g()}u=I.frame(function M(){s&&!(p.width===i.width&&p.height===i.height)&&(p.width=o.width=i.width,p.height=o.height=i.height),!p.width&&!p.height&&(m(o),p.width=o.width,p.height=o.height),d.clearRect(0,0,p.width,p.height),f=f.filter(function(v){return function bt(o,r){r.x+=Math.cos(r.angle2D)*r.velocity+r.drift,r.y+=Math.sin(r.angle2D)*r.velocity+r.gravity,r.wobble+=r.wobbleSpeed,r.velocity*=r.decay,r.tiltAngle+=.1,r.tiltSin=Math.sin(r.tiltAngle),r.tiltCos=Math.cos(r.tiltAngle),r.random=Math.random()+2,r.wobbleX=r.x+10*r.scalar*Math.cos(r.wobble),r.wobbleY=r.y+10*r.scalar*Math.sin(r.wobble);var m=r.tick++/r.totalTicks,p=r.x+r.random*r.tiltCos,h=r.y+r.random*r.tiltSin,f=r.wobbleX+r.random*r.tiltCos,d=r.wobbleY+r.random*r.tiltSin;if(o.fillStyle="rgba("+r.color.r+", "+r.color.g+", "+r.color.b+", "+(1-m)+")",o.beginPath(),"circle"===r.shape)o.ellipse?o.ellipse(r.x,r.y,Math.abs(f-p)*r.ovalScalar,Math.abs(d-h)*r.ovalScalar,Math.PI/10*r.wobble,0,2*Math.PI):function wt(o,r,m,p,h,f,d,u,w){o.save(),o.translate(r,m),o.rotate(f),o.scale(p,h),o.arc(0,0,1,d,u,w),o.restore()}(o,r.x,r.y,Math.abs(f-p)*r.ovalScalar,Math.abs(d-h)*r.ovalScalar,Math.PI/10*r.wobble,0,2*Math.PI);else if("star"===r.shape)for(var u=Math.PI/2*3,w=4*r.scalar,x=8*r.scalar,g=r.x,D=r.y,M=5,v=Math.PI/M;M--;)g=r.x+Math.cos(u)*x,D=r.y+Math.sin(u)*x,o.lineTo(g,D),u+=v,g=r.x+Math.cos(u)*w,D=r.y+Math.sin(u)*w,o.lineTo(g,D),u+=v;else o.moveTo(Math.floor(r.x),Math.floor(r.y)),o.lineTo(Math.floor(r.wobbleX),Math.floor(h)),o.lineTo(Math.floor(f),Math.floor(d)),o.lineTo(Math.floor(p),Math.floor(r.wobbleY));return o.closePath(),o.fill(),r.tick<r.totalTicks}(d,v)}),f.length?u=I.frame(M):D()}),w=D});return{addFettis:function(g){return f=f.concat(g),x},canvas:o,promise:x,reset:function(){u&&I.cancel(u),w&&w()}}}(o,ae,u,re,oe)).promise}function M(v){var re=h||b(v,"disableForReducedMotion",Boolean),oe=b(v,"zIndex",Number);if(re&&x)return C(function(S){S()});m&&g?o=g.canvas:m&&!o&&(o=function vt(o){var r=document.createElement("canvas");return r.style.position="fixed",r.style.top="0px",r.style.left="0px",r.style.pointerEvents="none",r.style.zIndex=o,r}(oe),document.body.appendChild(o)),p&&!w&&u(o);var F={width:o.width,height:o.height};function z(){if(d){var S={getBoundingClientRect:function(){if(!m)return o.getBoundingClientRect()}};return u(S),void d.postMessage({resize:{width:S.width,height:S.height}})}F.width=F.height=null}function X(){g=null,p&&n.removeEventListener("resize",z),m&&o&&(document.body.removeChild(o),o=null,w=!1)}return d&&!w&&d.init(o),w=!0,d&&(o.__confetti_initialized=!0),p&&n.addEventListener("resize",z,!1),d?d.fire(v,F,X):D(v,F,X)}return M.reset=function(){d&&d.reset(),g&&g.reset()},M}function be(){return ne||(ne=ye(null,{useWorker:!0,resize:!0})),ne}e.exports=function(){return be().apply(this,arguments)},e.exports.reset=function(){be().reset()},e.exports.create=ye}(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),V,!1);const xe=V.exports;class G{constructor(){this.fn=xe,this.defaultOptions={particleCount:100,spread:70,origin:{y:.7}}}getOptions(n){return Object.assign({},this.defaultOptions,n??{})}run(n){const e=this.getOptions(n);return this.fn(e)}runDelay(n=0,e){return setTimeout(()=>this.run(e),n??0)}static#e=this.\u0275fac=function(e){return new(e||G)};static#t=this.\u0275prov=t.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"})}class U{constructor(n){this.confetti=n,this._options={...this.confetti.defaultOptions}}set options(n){this._options=this.confetti.getOptions(n)}get options(){return this._options}ngOnInit(){clearTimeout(this.timer),this.timer=this.confetti.runDelay(this.options.delay,this.options)}ngOnDestroy(){clearTimeout(this.timer)}static#e=this.\u0275fac=function(e){return new(e||U)(t.Y36(G))};static#t=this.\u0275dir=t.lG2({type:U,selectors:[["","confetti",""]],inputs:{options:["confetti","options"]},exportAs:["confetti"]})}class W{static#e=this.\u0275fac=function(e){return new(e||W)};static#t=this.\u0275mod=t.oAB({type:W});static#n=this.\u0275inj=t.cJS({})}var Oe=y(3336);class L{constructor(){this.fill=!1,this.fillColor="var(--color-accent)"}static#e=this.\u0275fac=function(e){return new(e||L)};static#t=this.\u0275cmp=t.Xpm({type:L,selectors:[["app-star"]],inputs:{fill:"fill",fillColor:"fillColor"},decls:2,vars:2,template:function(e,s){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"star"),t.qZA()),2&e&&t.Udp("color",s.fill?s.fillColor:"var(--color-fg-op-50)")},dependencies:[Oe.Hw],styles:["[_nghost-%COMP%]{display:inline-block}"]})}function Te(a,n){if(1&a&&(t.TgZ(0,"span",1),t._UZ(1,"app-star",2),t.qZA()),2&a){const e=n.$implicit,s=n.index,i=t.oxw();t.Udp("transform",i.warpedStyles[s]),t.xp6(1),t.Q6J("fill",null!=i.ratio&&i.ratio>=e)}}class E{constructor(){this.ratios=[0,.5,.9],this.warpedStyles=[]}ngOnChanges(){this.calcWarpedStyles()}calcWarpedStyles(){if(!this.warped)return;const n=this.warped,e=this.ratios.length/2,s=Math.ceil(e),i=new Array(s).fill(0).map((c,l)=>n*(l/(s-1)-n/2));i.push(i[i.length-1]),this.warpedStyles=this.ratios.map((c,l)=>`translateY(${-(l<=e?i[l]:i[2*e-l-1])}em)`)}static#e=this.\u0275fac=function(e){return new(e||E)};static#t=this.\u0275cmp=t.Xpm({type:E,selectors:[["app-stars"]],inputs:{ratio:"ratio",ratios:"ratios",warped:"warped"},features:[t.TTD],decls:1,vars:1,consts:[["class","star-wrapper",3,"transform",4,"ngFor","ngForOf"],[1,"star-wrapper"],[3,"fill"]],template:function(e,s){1&e&&t.YNc(0,Te,2,3,"span",0),2&e&&t.Q6J("ngForOf",s.ratios)},dependencies:[_.sg,L],styles:[".star-wrapper[_ngcontent-%COMP%]{display:inline-block}"]})}class ${static#e=this.\u0275fac=function(e){return new(e||$)};static#t=this.\u0275mod=t.oAB({type:$});static#n=this.\u0275inj=t.cJS({imports:[_.ez,ce.q]})}var Ie=y(655),Se=y(727);const Ge=t.GuJ,ke=Symbol("__destroy"),le=Symbol("__decoratorApplied");function me(a){a instanceof Se.w0&&a.unsubscribe()}function fe(a,n){return function(){if(a&&a.call(this),function ue(a,n){a[n]&&(a[n].next(),a[n].complete(),a[n]=null)}(this,function pe(a){return"string"==typeof a?Symbol(`__destroy__${a}`):ke}()),n.arrayName&&function Ue(a){Array.isArray(a)&&a.forEach(me)}(this[n.arrayName]),n.checkProperties)for(const e in this)n.blackList?.includes(e)||me(this[e])}}Symbol("CheckerHasBeenSet");var A=(()=>{return(a=A||(A={}))[a.MapLowerToUpper=0]="MapLowerToUpper",a[a.MapUpperToLower=1]="MapUpperToLower",A;var a})(),N=y(5861),we=y(1135),B=y(4004),K=y(9841),Ne=y(1884),Be=y(9300),Je=y(1881),je=y(2313);class O{constructor(n){this.store=n,this.game$=new we.X(null),this.wordsetId$=this.game$.pipe((0,B.U)(e=>e?.wordsetId)),this.wordset$=(0,K.a)([this.store.wordSets$,this.wordsetId$]).pipe((0,B.U)(([e,s])=>e.find(i=>i.id===s))),this._subGameIndex$=new we.X(0),this.subGameIndex$=this._subGameIndex$.asObservable(),this.subGame$=(0,K.a)([this.subGameIndex$,this.game$]).pipe((0,B.U)(([e,s])=>s?.subGames[e])),this.gameInfo$=(0,K.a)([this.game$,this.wordset$,this.subGameIndex$]).pipe((0,Ne.x)(Je.Q),(0,Be.h)(([e,s])=>!(!e||!s)),(0,B.U)(([e,s,i])=>{const c=(e?.subGames||[]).map((C,I)=>({index:I,...C}));return{...e,wordset:s,subGames:c,subGame:{curr:c[i],prev:c[i-1],next:c[i+1]}}}))}init(n,e){const s=Object.values(A).filter(l=>"number"==typeof l);e||(e=s);const c={wordsetId:n,subGames:e.filter(l=>s.includes(parseInt(l.toString()))).map(l=>({type:l}))};return this.game$.next(c),this._subGameIndex$.next(0),c}setSubGameIndex(n){null==n&&(n=(this.game$.value?.subGames||[]).findIndex(e=>!!e.endedAt)),(n<0||n>=(this.game$.value?.subGames||[]).length)&&(n=0),this._subGameIndex$.next(n)}patchSubGame(n){var e=this;return(0,N.Z)(function*(){const s=e.game$.value;if(!s||!s.subGames)return;const c={...s.subGames[e._subGameIndex$.value],...n},l={...s,subGames:[...s.subGames]};return l.subGames[e._subGameIndex$.value]=c,e.game$.next(l),l})()}static#e=this.\u0275fac=function(e){return new(e||O)(t.LFG(je.d))};static#t=this.\u0275prov=t.Yz7({token:O,factory:O.\u0275fac})}var Re=y(4859);function Ye(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"Next"),t.qZA())}function Qe(a,n){1&a&&(t.TgZ(0,"span"),t._uU(1,"Close"),t.qZA())}const He=function(){return{delay:2e3}};function ze(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"header",3)(3,"h1",4),t._uU(4,"Nice job!"),t.qZA()(),t.TgZ(5,"div",5)(6,"div",6),t._UZ(7,"app-stars",7),t.qZA()(),t.TgZ(8,"footer",3)(9,"button",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.close.emit())}),t.YNc(10,Ye,2,0,"span",9),t.YNc(11,Qe,2,0,"span",9),t.qZA()()()()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("confetti",t.DdM(5,He)),t.xp6(6),t.Q6J("ratio",null==e.currSubGame?null:e.currSubGame.scoreRatio)("warped",.3),t.xp6(3),t.Q6J("ngIf",e.nextSubGame),t.xp6(1),t.Q6J("ngIf",!e.nextSubGame)}}class J{constructor(){this.close=new t.vpe}get show(){return!(!this.currSubGame?.endedAt||!this.currSubGame.scoreRatio)}static#e=this.\u0275fac=function(e){return new(e||J)};static#t=this.\u0275cmp=t.Xpm({type:J,selectors:[["app-game-ended"]],inputs:{currSubGame:"currSubGame",nextSubGame:"nextSubGame"},outputs:{close:"close"},decls:1,vars:1,consts:[["class","modal-wrapper fadeIn",4,"ngIf"],[1,"modal-wrapper","fadeIn"],[1,"modal-box","scaleUp",3,"confetti"],[1,"p-1","text-center"],[1,"m-0","scaleUp"],[1,"px-1","flex-center"],[1,"ts-300p","lh-80"],[1,"d-block",3,"ratio","warped"],["mat-raised-button","","color","primary",3,"click"],[4,"ngIf"]],template:function(e,s){1&e&&t.YNc(0,ze,12,6,"div",0),2&e&&t.Q6J("ngIf",s.show)},dependencies:[_.O5,Re.lW,E,U],styles:[".fadeIn[_ngcontent-%COMP%]{opacity:0;animation:.5s _ngcontent-%COMP%_fadeIn forwards}.scaleUp[_ngcontent-%COMP%]{transform:scale(0);animation:.5s _ngcontent-%COMP%_scaleUp cubic-bezier(.5,0,.5,2.2) forwards}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_scaleUp{0%{transform:scale(0)}to{transform:scale(1)}}.modal-box[_ngcontent-%COMP%]{min-width:16em}.modal-box.scaleUp[_ngcontent-%COMP%]{animation-delay:.3s}.modal-box[_ngcontent-%COMP%]   h1.scaleUp[_ngcontent-%COMP%]{animation-delay:.8s}@keyframes _ngcontent-%COMP%_scaleUpSpin{0%{transform:scale(0) rotate(-180deg)}to{transform:scale(1) rotate(0)}}[_nghost-%COMP%]     app-stars .star-wrapper app-star{transform:scale(0) rotate(-180deg);animation:.7s _ngcontent-%COMP%_scaleUpSpin cubic-bezier(.5,0,.5,2.2) forwards}[_nghost-%COMP%]     app-stars .star-wrapper:nth-of-type(1) app-star{animation-delay:1s}[_nghost-%COMP%]     app-stars .star-wrapper:nth-of-type(2) app-star{animation-delay:1.2s}[_nghost-%COMP%]     app-stars .star-wrapper:nth-of-type(3) app-star{animation-delay:1.4s}"]})}const Xe=["*"];var T=(()=>{return(a=T||(T={})).Idle="idle",a.Hover="hover",a.Wrong="wrong",a.Correct="correct",T;var a})();class j{constructor(){this.state=T.Idle}static#e=this.\u0275fac=function(e){return new(e||j)};static#t=this.\u0275cmp=t.Xpm({type:j,selectors:[["app-word"]],inputs:{state:"state",bgcolor:"bgcolor",innerStyle:"innerStyle",innerClass:"innerClass"},ngContentSelectors:Xe,decls:2,vars:7,consts:[[3,"ngClass","ngStyle"]],template:function(e,s){1&e&&(t.F$t(),t.TgZ(0,"span",0),t.Hsn(1),t.qZA()),2&e&&(t.Gre("state-",s.state,""),t.Udp("background-color",s.bgcolor),t.Q6J("ngClass",s.innerClass)("ngStyle",s.innerStyle))},dependencies:[_.mk,_.PC],styles:["[_nghost-%COMP%] > span[_ngcontent-%COMP%]{display:block;position:relative;padding:.5em;color:var(--color-fg);background:var(--color-bg);background:white;border-radius:.5em;box-shadow:.1em .1em .25em var(--color-dark-op-10);border:.1em solid var(--color-fg-op-50);transition:.2s;transition-property:transform,box-shadow,background}[_nghost-%COMP%] > span.state-idle[_ngcontent-%COMP%], [_nghost-%COMP%] > span.state-hover[_ngcontent-%COMP%]{background:lightyellow}[_nghost-%COMP%] > span.state-hover[_ngcontent-%COMP%]{transform:scale(1.15)}[_nghost-%COMP%] > span.state-wrong[_ngcontent-%COMP%]{background:salmon!important;animation:.5s .2s _ngcontent-%COMP%_wrong ease-in-out 1}[_nghost-%COMP%] > span.state-correct[_ngcontent-%COMP%]{background:palegreen!important;animation:1.5s .1s _ngcontent-%COMP%_correct ease-in-out 1 forwards}@keyframes _ngcontent-%COMP%_wrong{0%,to{transform:translate(0)}15%,45%,75%{transform:translate(-.5em)}30%,60%,90%{transform:translate(.5em)}}@keyframes _ngcontent-%COMP%_correct{0%,10%,30%,50%{transform:scale(1)}20%,40%{transform:scale(1.15)}0%,80%{opacity:1}to{opacity:.5}}"]})}class R{constructor(){this.patch=new t.vpe}static#e=this.\u0275fac=function(e){return new(e||R)};static#t=this.\u0275cmp=t.Xpm({type:R,selectors:[["ng-component"]],inputs:{gameInfo:"gameInfo"},outputs:{patch:"patch"},decls:0,vars:0,template:function(e,s){},encapsulation:2})}var q=y(2340);function Ve(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",4),t.NdJ("cdkDragDropped",function(i){t.CHM(e);const c=t.oxw();return t.KtG(c.onDragDrop(i))}),t.TgZ(1,"app-word",5),t._uU(2),t.qZA()()}if(2&a){const e=t.oxw();t.Q6J("cdkDragData",e.currWord),t.xp6(2),t.hij(" ",e.formatWord(e.currWord,!0)," ")}}function Ke(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",6),t.NdJ("cdkDropListEntered",function(i){t.CHM(e);const c=t.oxw();return t.KtG(c.onDragEnter(i))})("cdkDropListExited",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.resetUI())}),t.TgZ(1,"app-word",7),t._uU(2),t.qZA()()}if(2&a){const e=n.$implicit,s=t.oxw();t.Q6J("cdkDropListDisabled",s.wordsDone.includes(e))("cdkDropListData",e),t.xp6(1),t.Q6J("state",s.wordState(e)),t.xp6(1),t.hij(" ",s.formatWord(e,!1)," ")}}const qe=function(){return[]};class Y extends R{constructor(n){super(),this.confetti=n,this.wordsDone=[],this.wrongMoves=[]}ngOnInit(){const n=Date.now();this.patch.emit({startedAt:n}),this.randomWord()}getStats(){const n=this.gameInfo?.wordset.words||[],e=this.wordsDone,s=n.filter(ee=>!this.wordsDone.includes(ee)),i=this.wordsDone.length,l=this.wrongMoves.length,C=i+l;return{allWords:n,wordsLeft:s,wordsDone:e,done:i,left:s.length,wrong:l,total:C,scoreRatio:C>0?i/C:0}}sendStats(){const{scoreRatio:n,left:e}=this.getStats(),s=e<=0?Date.now():void 0;this.patch.emit({scoreRatio:n,endedAt:s})}randomWord(){const{wordsLeft:n}=this.getStats(),e=Math.floor(Math.random()*n.length);this.currWord=n[e]}trackByValue(n,e){return e}formatWord(n,e){return n[e&&!this.inversed||this.inversed&&!e?"toLocaleUpperCase":"toLocaleLowerCase"]()}resetUI(){this.hoverWord=void 0,this.wrongWord=void 0}onDragDrop(n){var e=this;return(0,N.Z)(function*(){const s=n.item.data,i=n.container.data;s===i?(e.wordsDone.push(s),e.randomWord(),e.confettiByEvent(n.event)):(e.resetUI(),i&&!n.container.disabled&&(e.wrongMoves.push({from:s,to:i}),e.wrongWord=i,clearTimeout(e._aniTimer),e._aniTimer=setTimeout(()=>e.resetUI(),1200))),e.sendStats()})()}onDragEnter(n){this.resetUI(),this.hoverWord=n.container.data}wordState(n){return this.wordsDone.includes(n)?T.Correct:this.hoverWord===n?T.Hover:this.wrongWord===n?T.Wrong:T.Idle}confettiByEvent(n){const{clientX:e,clientY:s}=n.changedTouches?.[0]||n,{innerWidth:i,innerHeight:c}=n.view;this.confetti.run({origin:{x:e/i,y:s/c},particleCount:12,spread:70,startVelocity:15})}static#e=this.\u0275fac=function(e){return new(e||Y)(t.Y36(G))};static#t=this.\u0275cmp=t.Xpm({type:Y,selectors:[["app-map-lower-upper-words"]],inputs:{inversed:"inversed"},features:[t.qOj],decls:5,vars:4,consts:[["cdkDropListGroup","",1,"wrapper","full-fill","bg-op-5"],["cdkDropList","",1,"flex-center"],["class","p-1","cdkDrag","",3,"cdkDragData","cdkDragDropped",4,"ngIf"],["cdkDropList","",3,"cdkDropListDisabled","cdkDropListData","cdkDropListEntered","cdkDropListExited",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",1,"p-1",3,"cdkDragData","cdkDragDropped"],["bgcolor","var(--color-primary-light-2)","innerClass","px-1 ts-120p"],["cdkDropList","",3,"cdkDropListDisabled","cdkDropListData","cdkDropListEntered","cdkDropListExited"],[3,"state"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0)(1,"main",1),t.YNc(2,Ve,3,2,"div",2),t.qZA(),t.TgZ(3,"aside"),t.YNc(4,Ke,3,4,"div",3),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngIf",s.currWord),t.xp6(2),t.Q6J("ngForOf",(null==s.gameInfo||null==s.gameInfo.wordset?null:s.gameInfo.wordset.words)||t.DdM(3,qe))("ngForTrackBy",s.trackByValue))},dependencies:[_.sg,_.O5,q.Wj,q.Fd,q.Zt,j],styles:[".wrapper[_ngcontent-%COMP%]{display:grid;grid-template:auto/auto minmax(10em,30%)}@media (orientation: portrait){.wrapper[_ngcontent-%COMP%]{grid-template:8em auto/auto}}.wrapper[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]{display:grid;grid-template:auto/auto;align-items:center;overflow:auto;gap:.5em;padding:1em}@media (orientation: portrait){.wrapper[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]{grid-template:auto/repeat(2,calc(50% - .25em))}}.cdk-drag-placeholder[_ngcontent-%COMP%]{display:none}"]})}function et(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"app-map-lower-upper-words",5),t.NdJ("patch",function(i){t.CHM(e);const c=t.oxw(2);return t.KtG(c.game.patchSubGame(i))}),t.qZA()}if(2&a){const e=t.oxw().ngIf;t.Q6J("gameInfo",e)}}function tt(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"app-map-lower-upper-words",6),t.NdJ("patch",function(i){t.CHM(e);const c=t.oxw(2);return t.KtG(c.game.patchSubGame(i))}),t.qZA()}if(2&a){const e=t.oxw().ngIf;t.Q6J("gameInfo",e)("inversed",!0)}}function nt(a,n){if(1&a){const e=t.EpF();t.ynx(0)(1,1),t.YNc(2,et,1,1,"app-map-lower-upper-words",2),t.YNc(3,tt,1,2,"app-map-lower-upper-words",3),t.BQk(),t.TgZ(4,"app-game-ended",4),t.NdJ("close",function(){const c=t.CHM(e).ngIf,l=t.oxw();return t.KtG(l.setNextOrExit(c.subGame.next))}),t.qZA(),t.BQk()}if(2&a){const e=n.ngIf,s=t.oxw();t.xp6(1),t.Q6J("ngSwitch",e.subGame.curr.type),t.xp6(1),t.Q6J("ngSwitchCase",s.SubGameType.MapLowerToUpper),t.xp6(1),t.Q6J("ngSwitchCase",s.SubGameType.MapUpperToLower),t.xp6(1),t.Q6J("currSubGame",e.subGame.curr)("nextSubGame",e.subGame.next)}}let Q=class se{constructor(n,e){this.game=n,this.router=e,this.SubGameType=A}setNextOrExit(n){n?this.game.setSubGameIndex(n.index):this.router.navigate(["/home"])}static#e=this.\u0275fac=function(e){return new(e||se)(t.Y36(O),t.Y36(Z.F0))};static#t=this.\u0275cmp=t.Xpm({type:se,selectors:[["app-game"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"ngSwitch"],[3,"gameInfo","patch",4,"ngSwitchCase"],[3,"gameInfo","inversed","patch",4,"ngSwitchCase"],[3,"currSubGame","nextSubGame","close"],[3,"gameInfo","patch"],[3,"gameInfo","inversed","patch"]],template:function(e,s){1&e&&(t.YNc(0,nt,5,5,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,s.game.gameInfo$))},dependencies:[_.O5,_.RF,_.n9,J,Y,_.Ov],encapsulation:2})};Q=(0,Ie.gn)([function Ae(a={}){return n=>{!function Pe(a){return!!a[Ge]}(n)?function Le(a,n){a.prototype.ngOnDestroy=fe(a.prototype.ngOnDestroy,n)}(n,a):function Ee(a,n){const e=a.\u0275pipe;e.onDestroy=fe(e.onDestroy,n)}(n,a),function Fe(a){a.prototype[le]=!0}(n)}}()],Q);var rt=y(6805),ot=y(930);class P{constructor(n,e){this.game=n,this.router=e}canActivate(n){var e=this;return(0,N.Z)(function*(){const s=n.params.wordsetId,i=n.queryParams.subGames?.split(","),c=e.game.init(s,i);return e.router.createUrlTree(["/game",c.wordsetId])})()}static#e=this.\u0275fac=function(e){return new(e||P)(t.LFG(O),t.LFG(Z.F0))};static#t=this.\u0275prov=t.Yz7({token:P,factory:P.\u0275fac})}class k{constructor(n,e){this.game=n,this.router=e}canActivate(n){var e=this;return(0,N.Z)(function*(){const s=n.params.wordsetId,i=yield function at(a,n){const e="object"==typeof n;return new Promise((s,i)=>{const c=new ot.Hp({next:l=>{s(l),c.unsubscribe()},error:i,complete:()=>{e?s(n.defaultValue):i(new rt.K)}});a.subscribe(c)})}(e.game.game$),c=e.router.createUrlTree(["/game",s,"new"]);return!!i||c})()}static#e=this.\u0275fac=function(e){return new(e||k)(t.LFG(O),t.LFG(Z.F0))};static#t=this.\u0275prov=t.Yz7({token:k,factory:k.\u0275fac})}const st=[{path:":wordsetId",component:Q,canActivate:[k]},{path:":wordsetId/new",component:Q,canActivate:[P]}];class H{static#e=this.\u0275fac=function(e){return new(e||H)};static#t=this.\u0275mod=t.oAB({type:H});static#n=this.\u0275inj=t.cJS({providers:[O,P,k],imports:[_.ez,Z.Bz.forChild(st),ce.q,$,W]})}}}]);