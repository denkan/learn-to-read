"use strict";(self.webpackChunkordspelet=self.webpackChunkordspelet||[]).push([[383],{383:(W,_,r)=>{r.r(_),r.d(_,{HomeModule:()=>w});var m=r(6895),a=r(4006),c=r(6264),t=r(4650);class p{constructor(){this.longPress=new t.vpe,this.longPressEnd=new t.vpe,this.time=1e3,this._didSend=!1}onStart(e){clearTimeout(this._timer),this._timer=setTimeout(()=>{this.longPress.emit(e),this._didSend=!0},this.time)}onAbort(e){clearTimeout(this._timer),this._didSend&&this.longPressEnd.emit(e),this._didSend=!1}static#t=this.\u0275fac=function(o){return new(o||p)};static#e=this.\u0275dir=t.lG2({type:p,selectors:[["","longpress",""]],hostBindings:function(o,n){1&o&&t.NdJ("touchstart",function(s){return n.onStart(s)})("mousedown",function(s){return n.onStart(s)})("touchend",function(s){return n.onAbort(s)},!1,t.Jf7)("mouseup",function(s){return n.onAbort(s)},!1,t.Jf7)},inputs:{time:["longpressTime","time"]},outputs:{longPress:"longpress",longPressEnd:"longpressEnd"}})}class h{static#t=this.\u0275fac=function(o){return new(o||h)};static#e=this.\u0275mod=t.oAB({type:h});static#o=this.\u0275inj=t.cJS({})}var y=r(1929),f=r(4004),D=r(9841),C=r(8801),b=r(2340),O=r(3238);function P(d,e){if(1&d){const o=t.EpF();t.TgZ(0,"div",6)(1,"div",7),t.NdJ("click",function(){const s=t.CHM(o).$implicit,l=t.oxw(2);return t.KtG(l.gotoLink(["/game",s.id]))})("longpress",function(){t.CHM(o);const i=t.oxw(2);return t.KtG(i.setEditMode(!0))})("longpressEnd",function(){t.CHM(o);const i=t.oxw(2);return t.KtG(i.enableClick())}),t.TgZ(2,"b"),t._uU(3),t.qZA()()()}if(2&d){const o=e.$implicit,n=e.index,i=t.oxw(2);t.xp6(1),t.Udp("animation-delay",-n%4*.2+"s"),t.Q6J("matRippleDisabled",i.editMode),t.xp6(2),t.Oqu(o.title)}}function Z(d,e){if(1&d){const o=t.EpF();t.TgZ(0,"div",1),t.NdJ("click",function(){t.CHM(o);const i=t.oxw();return t.KtG(i.editMode&&i.setEditMode(!1))}),t.TgZ(1,"div",2),t.NdJ("cdkDropListDropped",function(i){t.CHM(o);const s=t.oxw();return t.KtG(s.onBoxSortDrop(i))}),t.TgZ(2,"div",3)(3,"div",4),t.NdJ("click",function(){t.CHM(o);const i=t.oxw();return t.KtG(i.gotoLink("new"))}),t.TgZ(4,"b"),t._uU(5,"+"),t.qZA()()(),t.YNc(6,P,4,4,"div",5),t.qZA()()}if(2&d){const o=e.ngIf,n=t.oxw();t.ekj("edit-mode",n.editMode)("disable-click",n.clickDisabled),t.xp6(1),t.Q6J("cdkDropListDisabled",!n.editMode)("cdkDropListData",o.wordSets),t.xp6(2),t.Q6J("matRippleDisabled",n.editMode),t.xp6(3),t.Q6J("ngForOf",o.wordSets)}}class g{constructor(e,o,n){this.store=e,this.router=o,this.route=n,this.wordsetsSorted$=this.store.wordSets$.pipe((0,f.U)(i=>i.reverse())),this.$$=(0,D.a)([this.wordsetsSorted$]).pipe((0,f.U)(([i])=>({wordSets:i}))),this.editMode=!1,this.clickDisabled=!1}gotoLink(e){this.editMode||("string"==typeof e&&(e=[e]),this.router.navigate(e,{relativeTo:this.route}))}setEditMode(e){this.editMode=e,this.clickDisabled=e}enableClick(){clearTimeout(this._enableClickTimer),this._enableClickTimer=setTimeout(()=>{this.clickDisabled=!1},100)}onBoxSortDrop(e){console.log(e)}static#t=this.\u0275fac=function(o){return new(o||g)(t.Y36(C.d),t.Y36(c.F0),t.Y36(c.gz))};static#e=this.\u0275cmp=t.Xpm({type:g,selectors:[["app-home"]],decls:3,vars:3,consts:[["class","wrapper full-fill overflow-auto bg-op-5",3,"edit-mode","disable-click","click",4,"ngIf"],[1,"wrapper","full-fill","overflow-auto","bg-op-5",3,"click"],["cdkDropList","","cdkDropListOrientation","horizontal",1,"box-list",3,"cdkDropListDisabled","cdkDropListData","cdkDropListDropped"],[1,"box-wrapper"],["matRipple","",1,"box","new",3,"matRippleDisabled","click"],["class","box-wrapper","cdkDrag","",4,"ngFor","ngForOf"],["cdkDrag","",1,"box-wrapper"],["matRipple","",1,"box",3,"matRippleDisabled","click","longpress","longpressEnd"]],template:function(o,n){1&o&&(t.YNc(0,Z,7,8,"div",0),t.ALo(1,"async"),t._UZ(2,"router-outlet")),2&o&&t.Q6J("ngIf",t.lcZ(1,1,n.$$))},dependencies:[m.sg,m.O5,c.lC,b.Wj,b.Zt,O.wG,p,m.Ov],styles:[".wrapper[_ngcontent-%COMP%]{background:rgba(0,0,0,.1)}.wrapper.disable-click[_ngcontent-%COMP%]{pointer-events:none}.box-list[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:center;align-items:center;width:-moz-fit-content;width:fit-content;min-width:100%;padding:1em;position:absolute;top:50%;left:0;transform:translateY(-50%)}@media (orientation: portrait){.box-list[_ngcontent-%COMP%]{flex-direction:column;height:-moz-fit-content;height:fit-content;min-height:100%;top:0;left:50%;transform:translate(-50%)}}.box[_ngcontent-%COMP%]{width:calc(25% - 2em);min-width:7em;background:white;border-radius:.5em;box-shadow:.1em .1em .25em var(--color-dark-op-10);border:.1em solid var(--color-fg-op-50);height:4em;display:flex;flex-direction:column;justify-content:center;align-items:center;margin:.5em;padding:1em;text-decoration:none;transition:.2s;transition-property:transform,box-shadow;font-size:130%}@media (orientation: portrait){.box[_ngcontent-%COMP%]{font-size:110%}}.box[_ngcontent-%COMP%]:hover{background:white;border-radius:.5em;box-shadow:.1em .1em 1em var(--color-dark-op-25);border:.1em solid var(--color-fg);transform:scale(1.05) translateY(-.1em)}.box.new[_ngcontent-%COMP%]{background:var(--color-primary);color:var(--color-primary-contrast)}.box.new[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{font-size:300%}.wrapper.edit-mode[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_wobble .3s infinite linear}.wrapper.edit-mode[_ngcontent-%COMP%]   .box.new[_ngcontent-%COMP%]{animation:none}@keyframes _ngcontent-%COMP%_wobble{0%,50%,to{transform:rotate(0)}25%{transform:rotate(-3deg)}75%{transform:rotate(3deg)}}.cdk-drag-preview[_ngcontent-%COMP%]{transition:none}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}"]})}var x=r(9521),M=r(9300),H=r(3900),E=r(4859),T=r(7676),A=r(4144),v=r(7331),F=r(3336);function J(d,e){if(1&d){const o=t.EpF();t.TgZ(0,"mat-chip-row",14),t.NdJ("removed",function(){const s=t.CHM(o).$implicit,l=t.oxw();return t.KtG(l.removeWord(s))}),t._uU(1),t.TgZ(2,"button",15)(3,"mat-icon"),t._uU(4,"cancel"),t.qZA()()()}if(2&d){const o=e.$implicit;t.xp6(1),t.hij(" ",o," "),t.xp6(1),t.uIk("aria-label","remove "+o)}}class u{constructor(e,o,n,i){this.fb=e,this.store=o,this.route=n,this.router=i,this.minWords=2,this.separatorKeysCodes=[x.K5,x.OC],this.form=this.fb.group({id:[""],title:["",a.kI.required],words:[[],L(this.minWords)]}),this.trackEditIndex()}get isEditing(){const{id:e}=this.form.value||{};return!!e}trackEditIndex(){this.route.params.pipe((0,f.U)(e=>e?.id),(0,M.h)(e=>!!e),(0,H.w)(e=>this.store.wordSets$.pipe((0,f.U)(o=>o.find(n=>n.id==e)))),(0,M.h)(e=>!!e)).subscribe(e=>{this.form.patchValue(e)})}addWord(e){const o=e.value?.trim()?.toLocaleLowerCase();if(o){const n=[...this.form.value.words||[]];n.push(o),this.form.patchValue({words:n}),e.chipInput.clear()}}removeWord(e){const o=(this.form.value.words||[]).filter(n=>n!==e);this.form.patchValue({words:o})}onSubmit(){const{id:e,title:o,words:n}=this.form.value||{};if(!(o&&n&&n.length>=this.minWords))return;const s=[...this.store.data.wordSets],l={title:o,words:n,id:window.btoa(Date.now()-Math.round(Math.random()*Date.now()*.7)+"")},k=s.findIndex(U=>U.id===e);this.isEditing&&e&&k>=0?s[k]=l:s.push(l),this.store.patch({wordSets:s}),this.router.navigate(["../"])}static#t=this.\u0275fac=function(o){return new(o||u)(t.Y36(a.qu),t.Y36(C.d),t.Y36(c.gz),t.Y36(c.F0))};static#e=this.\u0275cmp=t.Xpm({type:u,selectors:[["app-wordset-form"]],decls:23,vars:8,consts:[[1,"wrapper","full-fill","flex-fill","flex-center","bg-dark-op-50"],[1,"border-box-150","p-1",3,"formGroup","ngSubmit"],[1,"ts-150p","flex-center"],["appearance","outline",1,"w-100","ts-120p"],["matInput","","formControlName","title","autofocus",""],["aria-label","Enter words"],["chipGrid",""],[3,"removed",4,"ngFor","ngForOf"],["placeholder","Add word...",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[1,"flex-center"],["type","submit","mat-raised-button","","color","primary",1,"",3,"disabled"],[1,"text-upper"],["routerLink","../",1,"close","ts-125p"],[1,"ts"],[3,"removed"],["matChipRemove",""]],template:function(o,n){if(1&o&&(t.TgZ(0,"div",0)(1,"form",1),t.NdJ("ngSubmit",function(){return n.onSubmit()}),t.TgZ(2,"h1",2),t._uU(3),t.qZA(),t.TgZ(4,"mat-form-field",3)(5,"mat-label"),t._uU(6,"Title"),t.qZA(),t._UZ(7,"input",4),t.qZA(),t.TgZ(8,"mat-form-field",3)(9,"mat-label"),t._uU(10,"Words to learn"),t.qZA(),t.TgZ(11,"mat-chip-grid",5,6),t.YNc(13,J,5,2,"mat-chip-row",7),t.TgZ(14,"input",8),t.NdJ("matChipInputTokenEnd",function(s){return n.addWord(s)}),t.qZA()()(),t._UZ(15,"hr"),t.TgZ(16,"div",9)(17,"button",10)(18,"strong",11),t._uU(19),t.qZA()(),t.TgZ(20,"a",12)(21,"mat-icon",13),t._uU(22,"close"),t.qZA()()()()()),2&o){const i=t.MAs(12);t.xp6(1),t.Q6J("formGroup",n.form),t.xp6(2),t.hij(" ",n.isEditing?"Edit word set":"Create new word set"," "),t.xp6(10),t.Q6J("ngForOf",n.form.value.words),t.xp6(1),t.Q6J("matChipInputFor",i)("matChipInputSeparatorKeyCodes",n.separatorKeysCodes)("matChipInputAddOnBlur",!0),t.xp6(3),t.Q6J("disabled",n.form.invalid),t.xp6(2),t.hij(" ",n.isEditing?"Save":"Create"," ")}},dependencies:[m.sg,c.rH,E.lW,T.KE,T.hX,A.Nt,v.RA,v.oH,v.qH,v.z3,F.Hw,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u],styles:["form[_ngcontent-%COMP%]{width:30em;max-width:90%;position:relative;border-color:var(--color-fg-op-75)}form[_ngcontent-%COMP%]   a.close[_ngcontent-%COMP%]{position:absolute;top:-.5em;right:-.5em;height:1.25em;width:1.25em;display:flex;justify-content:center;align-items:center;border-radius:.25em;background:var(--color-fg);color:var(--color-bg)}"]})}const L=d=>e=>e.value.length>=d?null:{MinLengthArray:!0},I=[{path:"",component:g,children:[{path:"new",component:u},{path:"edit/:id",component:u}]}];class w{static#t=this.\u0275fac=function(o){return new(o||w)};static#e=this.\u0275mod=t.oAB({type:w});static#o=this.\u0275inj=t.cJS({imports:[m.ez,c.Bz.forChild(I),y.q,a.UX,h]})}}}]);